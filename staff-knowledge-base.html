<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Knowledge Base - Be Well LifeStyle Centers</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--bg-color);
        }
        
        .auth-box {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 12px;
            border: 1px solid rgba(164, 124, 91, 0.3);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }
        
        .auth-box h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            color: var(--text-color);
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(164, 124, 91, 0.3);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            font-size: 1rem;
        }
        
        .auth-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 100%;
        }
        
        .auth-btn:hover {
            transform: translateY(-2px);
        }
        
        .knowledge-base {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
        }
        
        .kb-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
        }
        
        .kb-header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .kb-section {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid rgba(164, 124, 91, 0.2);
            margin-bottom: 25px;
            overflow: hidden;
        }
        
        .kb-section-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .kb-section-header:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
        }
        
        .kb-section-header h3 {
            margin: 0;
            font-size: 1.3rem;
        }
        
        .kb-section-content {
            padding: 25px;
            display: none;
        }
        
        .kb-section.open .kb-section-content {
            display: block;
        }
        
        .kb-section.open .kb-section-header .fas {
            transform: rotate(180deg);
        }
        
        .value-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: rgba(164, 124, 91, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .value-table th,
        .value-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(164, 124, 91, 0.2);
        }
        
        .value-table th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        
        .value-table td {
            color: var(--text-color);
        }
        
        .script-box {
            background: rgba(62, 91, 61, 0.1);
            border-left: 4px solid #3E5B3D;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .script-box h4 {
            color: #3E5B3D;
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .script-box p {
            margin: 5px 0;
            line-height: 1.6;
        }
        
        .highlight {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .logout-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--danger-color);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Authentication Section -->
    <div id="auth-section" class="auth-container">
        <button style="position: fixed; top: 20px; right: 20px; background: var(--primary-color); color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem;" onclick="window.location.href='index.html'">
            <i class="fas fa-home"></i> Home
        </button>
        <div class="auth-box">
            <img src="logo.svg" alt="Be Well Logo" style="height: 50px; width: auto; margin-bottom: 20px; filter: brightness(0) invert(1);">
            <h2>Staff Knowledge Base</h2>
            <p style="color: #9ca3af; margin-bottom: 25px;">Enter staff password to access</p>
            
            <form id="auth-form">
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="auth-btn">Access Knowledge Base</button>
            </form>
            
            <div id="auth-error" style="color: #ff6b6b; margin-top: 15px; display: none;">
                Incorrect password. Please try again.
            </div>
        </div>
    </div>

    <!-- Knowledge Base Content -->
    <div id="knowledge-base" class="knowledge-base">
        <div style="position: fixed; top: 20px; right: 20px; display: flex; gap: 10px;">
            <button class="logout-btn" onclick="window.location.href='index.html'" style="background: var(--primary-color);">
                <i class="fas fa-home"></i> Home
            </button>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
        
        <div class="kb-header">
            <h1><i class="fas fa-book-open"></i> Staff Knowledge Base</h1>
            <p style="color: #9ca3af; font-size: 1.1rem;">Everything you need to know about Be Well services, memberships, patient interactions, and inventory management</p>
        </div>
        
        <!-- Quick Links to New Systems -->
        <div class="kb-section" style="background: rgba(164, 124, 91, 0.1); border: 1px solid rgba(164, 124, 91, 0.3); margin-bottom: 30px;">
            <div class="kb-section-content" style="display: block; padding: 20px;">
                <h3 style="color: var(--primary-color); margin-bottom: 15px; font-size: 1.5rem;"><i class="fas fa-rocket"></i> Quick Access Systems</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <a href="cafe-operations-portal.html" target="_blank" style="background: #e74c3c; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-coffee" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Caf√© Operations</strong>
                    </a>
                    <a href="simple-inventory.html" target="_blank" style="background: #2980b9; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-boxes" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Inventory Ordering</strong>
                    </a>
                    <a href="recipe-inventory-tracker.html" target="_blank" style="background: #8e44ad; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-flask" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Recipe Tracker</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">View and manage patient check-ins</small>
                    </a>
                    <a href="#" onclick="openAdminDashboard(); return false;" style="background: #6366f1; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s; cursor: pointer;">
                        <i class="fas fa-users-cog" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Admin Dashboard</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">Member management & admin tools</small>
                    </a>
                    <a href="checklist-hub.html" style="background: var(--accent-color); color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-tasks" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Checklist Hub</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">Daily checklists & procedures</small>
                    </a>
                    <a href="front-desk-dashboard.html" target="_blank" style="background: #27ae60; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-desktop" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Front Desk - Birmingham</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">Check-in management dashboard</small>
                    </a>
                    <a href="patient-checkin.html" target="_blank" style="background: var(--secondary-color); color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-clipboard-check" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Patient Check-In Kiosk</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">For patient self check-in on iPad</small>
                    </a>
                    <!-- UWM Systems - Hidden until ready to roll out -->
                    <!-- 
                    <a href="front-desk-dashboard-uwm.html" target="_blank" style="background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-desktop" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Front Desk - UWM</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">UWM check-in dashboard</small>
                    </a>
                    <a href="patient-checkin-uwm.html" target="_blank" style="background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; text-decoration: none; display: block; text-align: center; transition: transform 0.3s;">
                        <i class="fas fa-clipboard-check" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <strong>Check-In Kiosk - UWM</strong>
                        <small style="display: block; margin-top: 5px; opacity: 0.9;">UWM patient self check-in</small>
                    </a>
                    -->
                </div>
            </div>
        </div>

        <!-- Admin Functions Section (only visible for admin users) -->
        <div id="admin-section" class="kb-section" style="background: rgba(220, 53, 69, 0.1); border: 2px solid #dc3545; margin-bottom: 30px; display: none;">
            <div class="kb-section-content" style="display: block; padding: 20px;">
                <h3 style="color: #dc3545; margin-bottom: 15px; font-size: 1.5rem;"><i class="fas fa-user-shield"></i> Admin Functions</h3>
                <p style="color: #6c757d; margin-bottom: 20px;">Administrative tools for managing staff accounts and system settings.</p>
                
                <!-- Edit Modal -->
                <div id="edit-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--card-bg); padding: 30px; border-radius: 8px; width: 90%; max-width: 500px;">
                        <h3 style="color: #dc3545; margin-bottom: 20px;">Edit Staff Member</h3>
                        <form id="edit-staff-form">
                            <input type="hidden" id="edit-staff-id">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Full Name:</label>
                                <input type="text" id="edit-staff-name" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Email:</label>
                                <input type="email" id="edit-staff-email" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Position:</label>
                                <input type="text" id="edit-staff-position" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Location:</label>
                                <select id="edit-staff-location" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                                    <option value="Birmingham">Birmingham</option>
                                    <option value="UWM">UWM</option>
                                    <option value="Berkeley">Berkeley</option>
                                    <option value="All">All Locations</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Access Level:</label>
                                <select id="edit-access-level" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                                    <option value="admin">Administrator</option>
                                    <option value="manager">Manager</option>
                                    <option value="staff">Staff</option>
                                    <option value="cafe">Caf√© Only</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Password:</label>
                                <input type="text" id="edit-staff-password" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button type="submit" style="background: #198754; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">Save Changes</button>
                                <button type="button" onclick="closeEditModal()" style="background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Add Staff Form -->
                <div style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(220, 53, 69, 0.3); border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="color: #dc3545; margin-bottom: 15px;"><i class="fas fa-user-plus"></i> Add New Staff Member</h4>
                    <form id="admin-add-staff-form">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="color: var(--text-color); display: block; margin-bottom: 5px; font-weight: 600;">Full Name:</label>
                                <input type="text" id="admin-staff-name" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div>
                                <label style="color: var(--text-color); display: block; margin-bottom: 5px; font-weight: 600;">Email:</label>
                                <input type="email" id="admin-staff-email" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div>
                                <label style="color: var(--text-color); display: block; margin-bottom: 5px; font-weight: 600;">Position:</label>
                                <input type="text" id="admin-staff-position" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                            <div>
                                <label style="color: var(--text-color); display: block; margin-bottom: 5px; font-weight: 600;">Location:</label>
                                <select id="admin-staff-location" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                                    <option value="">Select Location</option>
                                    <option value="Birmingham">Birmingham</option>
                                    <option value="UWM">UWM</option>
                                    <option value="Berkeley">Berkeley</option>
                                    <option value="All">All Locations</option>
                                </select>
                            </div>
                            <div>
                                <label style="color: var(--text-color); display: block; margin-bottom: 5px; font-weight: 600;">Access Level:</label>
                                <select id="admin-access-level" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                                    <option value="">Select Access Level</option>
                                    <option value="admin">Administrator</option>
                                    <option value="manager">Manager</option>
                                    <option value="staff">Staff</option>
                                    <option value="cafe">Caf√© Only</option>
                                </select>
                            </div>
                            <div>
                                <label style="color: var(--text-color); display: block; margin-bottom: 5px; font-weight: 600;">Password:</label>
                                <input type="text" id="admin-staff-password" placeholder="Auto-generated if empty" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                            </div>
                        </div>
                        <button type="submit" style="background: #dc3545; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-user-plus"></i> Add Staff Member
                        </button>
                    </form>
                </div>
                
                <!-- Current Staff List -->
                <div style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(220, 53, 69, 0.3); border-radius: 8px; padding: 20px;">
                    <h4 style="color: #dc3545; margin-bottom: 15px;"><i class="fas fa-users"></i> Current Staff Members</h4>
                    <div id="admin-staff-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                        <!-- Staff cards will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Membership Benefits Section -->
        <div class="kb-section">
            <div class="kb-section-header" onclick="toggleSection(this)">
                <h3><i class="fas fa-credit-card"></i> Membership Benefits & Value Explanations</h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="kb-section-content">
                <h4>Quick Value Explanations for Patients:</h4>
                
                <div class="script-box">
                    <h4>Restore - $149/mo</h4>
                    <p><strong>Script:</strong> "If you get even <span class="highlight">ONE massage per month</span>, you save money. A regular massage costs $115, but with Restore it's included PLUS you earn $15 in credits. You basically get your massage for $100 AND build credits for other services."</p>
                </div>
                
                <div class="script-box">
                    <h4>Revive - $299/mo</h4>
                    <p><strong>Script:</strong> "Perfect for <span class="highlight">bi-weekly massage clients</span>. Two massages normally cost $230/month. With Revive, both are included for $299. You pay only $70 more but get $30 in credits PLUS 10% off everything else. Net cost: only $40 more for tons of extra benefits."</p>
                </div>
                
                <div class="script-box">
                    <h4>Renew - $499/mo (MOST POPULAR)</h4>
                    <p><strong>Script:</strong> "Great for people who get <span class="highlight">multiple services</span>. A massage + IV + chiro normally costs $425. With Renew, all three are included for $499. You pay $75 more but get $50 in credits PLUS 10% off PLUS caf√© perks. Essentially break-even with massive extra benefits."</p>
                </div>
                
                <div class="script-box">
                    <h4>Total Wellness - $799/mo</h4>
                    <p><strong>Script:</strong> "For our <span class="highlight">wellness enthusiasts</span>. Five services could easily be $700+. With Total Wellness, all are included for $799 PLUS you get $80 in credits monthly PLUS weekly caf√© items. Perfect for comprehensive wellness."</p>
                </div>

                <h4>Key Talking Points:</h4>
                <ul style="color: var(--text-color); line-height: 1.8;">
                    <li><strong>"Think about what you already spend here monthly"</strong></li>
                    <li><strong>"The credits build up - it's like earning cash back"</strong></li>
                    <li><strong>"10% off applies to EVERYTHING, including future add-ons"</strong></li>
                    <li><strong>"The more services you use, the more you save"</strong></li>
                    <li><strong>"Credits expire in 6 months, so use them for extras you want to try"</strong></li>
                </ul>

                <table class="value-table">
                    <thead>
                        <tr>
                            <th>Membership</th>
                            <th>Monthly Fee</th>
                            <th>Services Included</th>
                            <th>Credits Earned</th>
                            <th>Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Restore</td>
                            <td>$149</td>
                            <td>Pick 1 service</td>
                            <td>$14.90</td>
                            <td>Monthly massage clients</td>
                        </tr>
                        <tr>
                            <td>Revive</td>
                            <td>$299</td>
                            <td>Pick 2 services</td>
                            <td>$29.90</td>
                            <td>Bi-weekly massage clients</td>
                        </tr>
                        <tr>
                            <td>Renew</td>
                            <td>$499</td>
                            <td>Pick 3 services</td>
                            <td>$49.90</td>
                            <td>Multi-service users</td>
                        </tr>
                        <tr>
                            <td>Total Wellness</td>
                            <td>$799</td>
                            <td>Pick 5 services</td>
                            <td>$79.90</td>
                            <td>Wellness enthusiasts</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Service Pricing Section -->
        <div class="kb-section">
            <div class="kb-section-header" onclick="toggleSection(this)">
                <h3><i class="fas fa-dollar-sign"></i> Service Pricing Reference</h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="kb-section-content">
                <table class="value-table">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Duration</th>
                            <th>Cash Price</th>
                            <th>Member Price (10% off)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Chiropractic</td>
                            <td>Varies</td>
                            <td>$85-90</td>
                            <td>$76.50-81</td>
                        </tr>
                        <tr>
                            <td>Massage - 60min</td>
                            <td>1 hour</td>
                            <td>$115</td>
                            <td>$103.50</td>
                        </tr>
                        <tr>
                            <td>Massage - 90min</td>
                            <td>1.5 hours</td>
                            <td>$170</td>
                            <td>$153</td>
                        </tr>
                        <tr>
                            <td>Colon Hydrotherapy</td>
                            <td>1 hour</td>
                            <td>$120-125</td>
                            <td>$108-112.50</td>
                        </tr>
                        <tr>
                            <td>IV Therapy (Basic)</td>
                            <td>30-60 mins</td>
                            <td>$190-255</td>
                            <td>$171-229.50</td>
                        </tr>
                        <tr>
                            <td>NAD+ IV</td>
                            <td>2-3 hours</td>
                            <td>$350-500</td>
                            <td>$315-450</td>
                        </tr>
                        <tr>
                            <td>Vitamin Shots</td>
                            <td>5 mins</td>
                            <td>$30-65</td>
                            <td>$27-58.50</td>
                        </tr>
                        <tr>
                            <td>Cupping</td>
                            <td>15-30 mins</td>
                            <td>$80</td>
                            <td>$72</td>
                        </tr>
                        <tr>
                            <td>Dry Needling</td>
                            <td>20 mins</td>
                            <td>$60-80</td>
                            <td>$54-72</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Common Questions Section -->
        <div class="kb-section">
            <div class="kb-section-header" onclick="toggleSection(this)">
                <h3><i class="fas fa-question-circle"></i> Common Patient Questions</h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="kb-section-content">
                <div class="script-box">
                    <h4>"What happens to my credits if I cancel?"</h4>
                    <p><strong>Answer:</strong> "Reserve credits are non-refundable if you cancel your membership. However, credits do carry over month to month and you have 6 months to use them, so you have plenty of time to enjoy the benefits before they expire."</p>
                </div>
                
                <div class="script-box">
                    <h4>"Can I change my membership level?"</h4>
                    <p><strong>Answer:</strong> "Absolutely! You can upgrade or downgrade at any time. Changes take effect with your next billing cycle. Any unused service allowances don't carry over, but your Reserve credits stay with you."</p>
                </div>
                
                <div class="script-box">
                    <h4>"What if I don't use all my services in a month?"</h4>
                    <p><strong>Answer:</strong> "Service allowances reset each month - they don't roll over. However, you're earning Reserve credits every month that you can use anytime for additional services. Think of the service allowances as your base benefits, and credits as your bonus savings."</p>
                </div>
                
                <div class="script-box">
                    <h4>"Can I share my membership with family?"</h4>
                    <p><strong>Answer:</strong> "Memberships are individual accounts. However, you can use your Reserve credits to pay for family members' services, and they'll still get the 10% member discount when you pay."</p>
                </div>
            </div>
        </div>

        <!-- Contact Information Section -->
        <div class="kb-section">
            <div class="kb-section-header" onclick="toggleSection(this)">
                <h3><i class="fas fa-phone"></i> Important Contacts & Resources</h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="kb-section-content">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: rgba(164, 124, 91, 0.1); padding: 20px; border-radius: 8px;">
                        <h4 style="color: var(--primary-color);">Emergency Contacts</h4>
                        <p>Main Line: (248) 792-6570</p>
                        <p>Manager: [Add contact]</p>
                        <p>Owner: [Add contact]</p>
                    </div>
                    
                    <div style="background: rgba(164, 124, 91, 0.1); padding: 20px; border-radius: 8px;">
                        <h4 style="color: var(--primary-color);">Quick Links</h4>
                        <p><a href="https://book.squareup.com/appointments/6pyjoccl1ik8ur/location/101VJFBVK1T29/services" target="_blank" style="color: var(--primary-color);">Booking System</a></p>
                        <p><a href="https://be-well-lifestyle-centers.square.site/" target="_blank" style="color: var(--primary-color);">Caf√© Ordering</a></p>
                        <p><a href="membership-purchase.html" target="_blank" style="color: var(--primary-color);">Membership Purchase</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Salesforce Chatter Guide Section -->
        <div class="kb-section">
            <div class="kb-section-header" onclick="toggleSection(this)">
                <h3><i class="fas fa-comments"></i> Salesforce Chatter - Staff Communication Guide</h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="kb-section-content">
                <div style="background: rgba(62, 91, 61, 0.1); border-left: 4px solid #3E5B3D; padding: 20px; margin-bottom: 20px; border-radius: 8px;">
                    <h4 style="color: #3E5B3D; margin-top: 0;">What is Chatter?</h4>
                    <p>Chatter is our internal messaging system built into Salesforce. Think of it as "Facebook for work" - you can post updates, message teammates, and stay connected across all Be Well locations.</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: rgba(164, 124, 91, 0.1); padding: 20px; border-radius: 8px;">
                        <h4 style="color: var(--primary-color);"><i class="fas fa-mobile-alt"></i> Getting Started</h4>
                        <ol style="margin-left: 20px;">
                            <li><strong>Desktop:</strong> Log into Salesforce ‚Üí Click "App Launcher" (9 dots) ‚Üí Select "Chatter"</li>
                            <li><strong>Mobile:</strong> Download "Salesforce Mobile" app ‚Üí Login ‚Üí Tap Chatter icon at bottom</li>
                            <li><strong>Notifications:</strong> Enable push notifications to never miss important messages</li>
                        </ol>
                    </div>
                    
                    <div style="background: rgba(164, 124, 91, 0.1); padding: 20px; border-radius: 8px;">
                        <h4 style="color: var(--primary-color);"><i class="fas fa-users"></i> Join Your Groups</h4>
                        <p><strong>Required Groups to Join:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>üìç Your location team (Birmingham/Berkeley/UWM)</li>
                            <li>üë• All Be Well Staff</li>
                            <li>üè• Your department (Front Desk, Providers, etc.)</li>
                        </ul>
                        <p style="margin-top: 10px;"><em>To join: Click Groups ‚Üí Search ‚Üí Join</em></p>
                    </div>
                </div>

                <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 2px solid var(--primary-color);">
                    <h4 style="color: var(--primary-color);"><i class="fas fa-comment-dots"></i> How to Use Chatter Effectively</h4>
                    
                    <div style="margin-bottom: 20px;">
                        <h5 style="color: #3E5B3D;">Making Posts:</h5>
                        <ul style="margin-left: 20px; color: #333;">
                            <li><strong style="color: #000;">@mention specific people:</strong> Type @ then their name (e.g., @SallySmith)</li>
                            <li><strong style="color: #000;">Use hashtags:</strong> #urgent #schedulechange #help</li>
                            <li><strong style="color: #000;">Attach photos:</strong> Click üìé to add images (great for inventory issues)</li>
                            <li><strong style="color: #000;">Polls:</strong> Create quick polls for team decisions</li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h5 style="color: #3E5B3D;">Common Use Cases:</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <div style="background: #f8f8f8; padding: 15px; border-radius: 6px; border: 1px solid #ddd; color: #333;">
                                <strong style="color: #000;">Schedule Changes:</strong><br>
                                "Hey @DrJones, your 3pm patient rescheduled to 4pm"
                            </div>
                            <div style="background: #f8f8f8; padding: 15px; border-radius: 6px; border: 1px solid #ddd; color: #333;">
                                <strong style="color: #000;">Coverage Requests:</strong><br>
                                "@FrontDeskTeam Can someone cover my lunch 12-1pm?"
                            </div>
                            <div style="background: #f8f8f8; padding: 15px; border-radius: 6px; border: 1px solid #ddd; color: #333;">
                                <strong style="color: #000;">Patient Updates:</strong><br>
                                "FYI @Birmingham Mrs. Johnson running 15 min late"
                            </div>
                            <div style="background: #f8f8f8; padding: 15px; border-radius: 6px; border: 1px solid #ddd; color: #333;">
                                <strong style="color: #000;">Supply Issues:</strong><br>
                                "@Managers We're out of parking validation stamps"
                            </div>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 8px; border: 1px solid #4caf50;">
                        <h4 style="color: #2e7d32;"><i class="fas fa-check-circle"></i> Do's</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ Keep messages professional and brief</li>
                            <li>‚úÖ Use @mentions for urgent items</li>
                            <li>‚úÖ Check Chatter at start/end of shift</li>
                            <li>‚úÖ Update your status (Available/Busy/Out)</li>
                            <li>‚úÖ Acknowledge important messages with üëç</li>
                            <li>‚úÖ Post in appropriate groups</li>
                        </ul>
                    </div>
                    
                    <div style="background: rgba(244, 67, 54, 0.1); padding: 20px; border-radius: 8px; border: 1px solid #f44336;">
                        <h4 style="color: #c62828;"><i class="fas fa-times-circle"></i> Don'ts</h4>
                        <ul style="margin-left: 20px;">
                            <li>‚ùå Share patient PHI or sensitive info</li>
                            <li>‚ùå Post personal/non-work content</li>
                            <li>‚ùå Use ALL CAPS (it's like yelling)</li>
                            <li>‚ùå Ignore urgent @mentions</li>
                            <li>‚ùå Post complaints publicly</li>
                            <li>‚ùå Share login credentials</li>
                        </ul>
                    </div>
                </div>

                <div style="background: rgba(255, 193, 7, 0.15); padding: 20px; border-radius: 8px; margin-top: 20px; border: 1px solid #ffc107;">
                    <h4 style="color: #856404;"><i class="fas fa-lightbulb"></i> Pro Tips</h4>
                    <ul style="margin-left: 20px;">
                        <li>üì± <strong>Mobile First:</strong> Use the mobile app for quick updates throughout your day</li>
                        <li>üîî <strong>Custom Notifications:</strong> Set different sounds for @mentions vs general posts</li>
                        <li>üì∏ <strong>Photo Power:</strong> A picture is worth 1000 words - use photos for inventory/maintenance issues</li>
                        <li>‚≠ê <strong>Follow Important People:</strong> Follow providers and managers to see their updates first</li>
                        <li>üìå <strong>Pin Important Posts:</strong> Pin announcements to keep them at the top of feeds</li>
                        <li>üîç <strong>Search is Powerful:</strong> Search old posts to find answers before asking again</li>
                    </ul>
                </div>

                <div style="text-align: center; margin-top: 30px; padding: 20px; background: rgba(164, 124, 91, 0.1); border-radius: 8px;">
                    <h4 style="color: var(--primary-color);">Need Help?</h4>
                    <p>Post in <strong>@AllStaff</strong> group with <strong>#ChatterHelp</strong> and someone will assist you!</p>
                    <p style="margin-top: 10px;">Remember: Chatter keeps our teams connected across all locations. Use it wisely! üí™</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Individual staff login system
        let staffData = JSON.parse(localStorage.getItem('staffData')) || [];
        let currentUser = null;
        
        // Initialize with default staff if empty
        if (staffData.length === 0) {
            staffData = [
                {
                    id: 'admin-001',
                    name: 'System Administrator',
                    email: 'admin@bewelllifestylecenters.com',
                    position: 'Administrator',
                    location: 'All',
                    accessLevel: 'admin',
                    password: '$Be7926570!ADMIN',
                    active: true
                },
                {
                    id: 'staff-001',
                    name: 'General Staff',
                    email: 'staff@bewelllifestylecenters.com',
                    position: 'Staff Member',
                    location: 'All',
                    accessLevel: 'staff',
                    password: '$Be7926570!',
                    active: true
                }
            ];
            localStorage.setItem('staffData', JSON.stringify(staffData));
        }
        
        // Bulletproof authentication setup
        function setupAuthentication() {
            const authForm = document.getElementById('auth-form');
            if (!authForm) {
                setTimeout(setupAuthentication, 100);
                return;
            }
            
            // Remove any existing listeners to prevent duplicates
            const newForm = authForm.cloneNode(true);
            authForm.parentNode.replaceChild(newForm, authForm);
            
            newForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const password = document.getElementById('password').value;
            
            // Direct password check - no server calls
            let staff = null;
            
            // Check against known passwords
            if (password === '$Be7926570!ADMIN') {
                staff = {
                    id: 'admin-001',
                    name: 'System Administrator',
                    email: 'admin@bewelllifestylecenters.com',
                    position: 'Administrator',
                    location: 'All',
                    accessLevel: 'admin',
                    active: true
                };
            } else if (password === '$Be7926570!') {
                staff = {
                    id: 'staff-001',
                    name: 'General Staff',
                    email: 'staff@bewelllifestylecenters.com',
                    position: 'Staff Member',
                    location: 'All',
                    accessLevel: 'staff',
                    active: true
                };
            } else {
                // Check localStorage for additional staff
                const localData = localStorage.getItem('staffData');
                if (localData) {
                    try {
                        const localStaff = JSON.parse(localData);
                        staff = localStaff.find(s => s.password === password && s.active);
                    } catch (e) {
                        console.error('Error parsing local staff data:', e);
                    }
                }
            }
            
            if (staff) {
                currentUser = staff;
                document.getElementById('auth-section').style.display = 'none';
                document.getElementById('knowledge-base').style.display = 'block';
                sessionStorage.setItem('staffAuthenticated', 'true');
                sessionStorage.setItem('currentUser', JSON.stringify(staff));
                
                // Update welcome message
                document.querySelector('.kb-header p').innerHTML = `Welcome back, <strong>${staff.name}</strong> (${staff.position}) - ${staff.location} Location<br><small style="color: #10b981;">‚úÖ Authentication successful</small>`;
                
                // Show/hide sections based on access level
                updateAccessPermissions(staff.accessLevel);
            } else {
                document.getElementById('auth-error').style.display = 'block';
                document.getElementById('auth-error').innerHTML = 'Incorrect password. Please try again.';
                document.getElementById('password').value = '';
            }
            });
        }
        
        // Start authentication setup immediately
        setupAuthentication();
        
        // Access permissions based on staff level
        function updateAccessPermissions(accessLevel) {
            const adminSection = document.getElementById('admin-section');
            const adminButton = document.querySelector('a[onclick="openAdminDashboard(); return false;"]');
            
            // Show/hide admin functions
            if (accessLevel === 'admin') {
                // Show admin section in the portal
                if (adminSection) {
                    adminSection.style.display = 'block';
                    initializeAdminForms();
                    loadAdminStaffData();
                }
                
                // Hide the old external admin dashboard button since we have it integrated now
                if (adminButton) adminButton.style.display = 'none';
                
            } else if (accessLevel === 'cafe') {
                // Caf√© staff only see caf√©-related systems
                const allLinks = document.querySelectorAll('.kb-section a');
                allLinks.forEach(link => {
                    if (link.href.includes('cafe-operations') || 
                        link.href.includes('inventory-management') || 
                        link.href.includes('recipe-inventory')) {
                        link.style.display = 'block';
                    } else if (link.onclick && (link.onclick.toString().includes('Dashboard') || 
                              link.onclick.toString().includes('Admin'))) {
                        link.style.display = 'none';
                    }
                });
            }
            
            // Hide certain sections for caf√©-only staff
            if (accessLevel === 'cafe') {
                const knowledgeSections = document.querySelectorAll('.kb-section');
                knowledgeSections.forEach((section, index) => {
                    if (index > 0) { // Keep first section (Quick Access) but hide others for caf√© staff
                        const header = section.querySelector('.kb-section-header');
                        if (header && !header.textContent.includes('Caf√©')) {
                            section.style.display = 'none';
                        }
                    }
                });
            }
        }
        
        // Load staff data on page load
        async function loadStaffDataForAuth() {
            try {
                // Try Dropbox authentication first (includes real passwords)
                const response = await fetch('/.netlify/functions/dropbox-manager', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'get-staff-for-auth'
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.staff) {
                        staffData = result.staff;
                        return;
                    }
                }
            } catch (error) {
                console.error('Dropbox auth data failed:', error);
            }
            
            // Fallback: Use hardcoded default accounts for now
            staffData = [
                {
                    id: 'admin-001',
                    name: 'System Administrator',
                    email: 'admin@bewelllifestylecenters.com',
                    position: 'Administrator',
                    location: 'All',
                    accessLevel: 'admin',
                    password: '$Be7926570!ADMIN',
                    active: true
                },
                {
                    id: 'staff-001',
                    name: 'General Staff',
                    email: 'staff@bewelllifestylecenters.com',
                    position: 'Staff Member',
                    location: 'All',
                    accessLevel: 'staff',
                    password: '$Be7926570!',
                    active: true
                }
            ];
            
            // Also check localStorage for any additional staff
            const localData = localStorage.getItem('staffData');
            if (localData) {
                try {
                    const localStaff = JSON.parse(localData);
                    // Merge with defaults (avoiding duplicates)
                    localStaff.forEach(staff => {
                        if (!staffData.find(s => s.id === staff.id)) {
                            staffData.push(staff);
                        }
                    });
                } catch (e) {
                    console.error('Error parsing local staff data:', e);
                }
            }
        }
        
        // Load staff data when page loads
        loadStaffDataForAuth();
        
        // Clear any existing sessions to prevent conflicts
        sessionStorage.removeItem('staffAuthenticated');
        sessionStorage.removeItem('currentUser');
        sessionStorage.removeItem('adminAuthenticated');
        
        // Logout function
        function logout() {
            sessionStorage.removeItem('staffAuthenticated');
            sessionStorage.removeItem('currentUser');
            currentUser = null;
            document.getElementById('auth-section').style.display = 'flex';
            document.getElementById('knowledge-base').style.display = 'none';
            document.getElementById('password').value = '';
        }
        
        // Open dashboard in new window
        function openDashboard() {
            window.open('front-desk-dashboard.html', '_blank');
        }
        
        // Open admin dashboard in new window
        function openAdminDashboard() {
            window.open('admin-dashboard.html', '_blank');
        }
        
        // Open staff admin dashboard in new window
        function openStaffAdmin() {
            window.open('staff-admin-dashboard.html', '_blank');
        }
        
        // Toggle sections
        function toggleSection(header) {
            const section = header.parentElement;
            section.classList.toggle('open');
        }
        
        // Auto-logout after 4 hours of inactivity
        let inactivityTimer;
        function resetInactivityTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(logout, 4 * 60 * 60 * 1000); // 4 hours
        }
        
        document.addEventListener('click', resetInactivityTimer);
        document.addEventListener('keypress', resetInactivityTimer);
        resetInactivityTimer();
        
        // Admin Functions (integrated into staff portal)
        function setupAdminFunctions() {
            const form = document.getElementById('admin-add-staff-form');
            if (!form) return;
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('admin-staff-name').value;
                const email = document.getElementById('admin-staff-email').value;
                const position = document.getElementById('admin-staff-position').value;
                const location = document.getElementById('admin-staff-location').value;
                const accessLevel = document.getElementById('admin-access-level').value;
                let password = document.getElementById('admin-staff-password').value;
                
                if (!password) {
                    password = generateAdminPassword();
                }
                
                const newStaff = {
                    id: 'staff-' + Date.now(),
                    name,
                    email,
                    position,
                    location,
                    accessLevel,
                    password,
                    active: true,
                    created: new Date().toISOString()
                };
                
                // Add to localStorage
                let staffData = JSON.parse(localStorage.getItem('staffData')) || [];
                staffData.push(newStaff);
                localStorage.setItem('staffData', JSON.stringify(staffData));
                
                alert(`‚úÖ Staff member added successfully!\n\nName: ${name}\nEmail: ${email}\nPassword: ${password}\n\nMake sure to share the password securely with the staff member.`);
                
                form.reset();
                loadAdminStaffData();
            });
        }
        
        function generateAdminPassword() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$';
            let password = '';
            for (let i = 0; i < 12; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return password;
        }
        
        function loadAdminStaffData() {
            const staffList = document.getElementById('admin-staff-list');
            if (!staffList) return;
            
            // Always load from localStorage for admin view to see real passwords
            let staffData = JSON.parse(localStorage.getItem('staffData')) || [];
            
            // If localStorage is empty, initialize with defaults
            if (staffData.length === 0) {
                staffData = [
                    {
                        id: 'admin-001',
                        name: 'System Administrator',
                        email: 'admin@bewelllifestylecenters.com',
                        position: 'Administrator',
                        location: 'All',
                        accessLevel: 'admin',
                        password: '$Be7926570!ADMIN',
                        active: true
                    },
                    {
                        id: 'staff-001',
                        name: 'General Staff',
                        email: 'staff@bewelllifestylecenters.com',
                        position: 'Staff Member',
                        location: 'All',
                        accessLevel: 'staff',
                        password: '$Be7926570!',
                        active: true
                    }
                ];
                localStorage.setItem('staffData', JSON.stringify(staffData));
            }
            
            // Auto-fix any hidden passwords
            let needsUpdate = false;
            staffData = staffData.map(staff => {
                if (staff.password === '***HIDDEN***') {
                    if (staff.id === 'admin-001' || staff.email === 'admin@bewelllifestylecenters.com') {
                        staff.password = '$Be7926570!ADMIN';
                        needsUpdate = true;
                    } else if (staff.id === 'staff-001' || staff.email === 'staff@bewelllifestylecenters.com') {
                        staff.password = '$Be7926570!';
                        needsUpdate = true;
                    }
                }
                return staff;
            });
            
            if (needsUpdate) {
                localStorage.setItem('staffData', JSON.stringify(staffData));
            }
            
            staffList.innerHTML = '';
            
            staffData.forEach(staff => {
                const card = document.createElement('div');
                card.style.cssText = 'background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(220, 53, 69, 0.3); border-radius: 6px; padding: 15px;';
                
                const accessColor = {
                    'admin': '#dc3545',
                    'manager': '#fd7e14',
                    'staff': '#198754',
                    'cafe': '#0dcaf0'
                };
                
                // Force display of actual passwords for known default accounts
                let displayPassword = staff.password;
                if (staff.id === 'admin-001' && displayPassword === '***HIDDEN***') {
                    displayPassword = '$Be7926570!ADMIN';
                } else if (staff.id === 'staff-001' && displayPassword === '***HIDDEN***') {
                    displayPassword = '$Be7926570!';
                }
                
                card.innerHTML = `
                    <h5 style="margin: 0 0 8px 0; color: var(--primary-color);">${staff.name}</h5>
                    <p style="margin: 3px 0; color: var(--text-color); font-size: 0.9rem;"><strong>Email:</strong> ${staff.email}</p>
                    <p style="margin: 3px 0; color: var(--text-color); font-size: 0.9rem;"><strong>Position:</strong> ${staff.position}</p>
                    <p style="margin: 3px 0; color: var(--text-color); font-size: 0.9rem;"><strong>Location:</strong> ${staff.location}</p>
                    <p style="margin: 3px 0; color: var(--text-color); font-size: 0.9rem;"><strong>Password:</strong> <span style="font-family: monospace; background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 3px;">${displayPassword}</span></p>
                    <span style="background: ${accessColor[staff.accessLevel] || '#6c757d'}; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8rem; text-transform: uppercase;">${staff.accessLevel}</span>
                    <div style="margin-top: 10px;">
                        <button onclick="editStaff('${staff.id}')" style="background: #0dcaf0; color: white; border: none; padding: 4px 8px; border-radius: 3px; font-size: 0.8rem; cursor: pointer;">Edit</button>
                        <button onclick="deleteStaff('${staff.id}')" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 3px; font-size: 0.8rem; cursor: pointer; margin-left: 5px;">Delete</button>
                    </div>
                `;
                
                staffList.appendChild(card);
            });
        }
        
        function deleteStaff(staffId) {
            if (!confirm('Are you sure you want to delete this staff member?')) return;
            
            let staffData = JSON.parse(localStorage.getItem('staffData')) || [];
            staffData = staffData.filter(s => s.id !== staffId);
            localStorage.setItem('staffData', JSON.stringify(staffData));
            
            loadAdminStaffData();
        }
        
        function editStaff(staffId) {
            const staffData = JSON.parse(localStorage.getItem('staffData')) || [];
            const staff = staffData.find(s => s.id === staffId);
            
            if (!staff) return;
            
            // Populate edit form
            document.getElementById('edit-staff-id').value = staff.id;
            document.getElementById('edit-staff-name').value = staff.name;
            document.getElementById('edit-staff-email').value = staff.email;
            document.getElementById('edit-staff-position').value = staff.position;
            document.getElementById('edit-staff-location').value = staff.location;
            document.getElementById('edit-access-level').value = staff.accessLevel;
            document.getElementById('edit-staff-password').value = staff.password;
            
            // Show modal
            document.getElementById('edit-modal').style.display = 'block';
        }
        
        function closeEditModal() {
            document.getElementById('edit-modal').style.display = 'none';
        }
        
        // Setup edit form handler
        function setupEditForm() {
            const form = document.getElementById('edit-staff-form');
            if (!form) return;
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const staffId = document.getElementById('edit-staff-id').value;
                let staffData = JSON.parse(localStorage.getItem('staffData')) || [];
                const staffIndex = staffData.findIndex(s => s.id === staffId);
                
                if (staffIndex !== -1) {
                    staffData[staffIndex] = {
                        ...staffData[staffIndex],
                        name: document.getElementById('edit-staff-name').value,
                        email: document.getElementById('edit-staff-email').value,
                        position: document.getElementById('edit-staff-position').value,
                        location: document.getElementById('edit-staff-location').value,
                        accessLevel: document.getElementById('edit-access-level').value,
                        password: document.getElementById('edit-staff-password').value
                    };
                    
                    localStorage.setItem('staffData', JSON.stringify(staffData));
                    
                    alert('‚úÖ Staff member updated successfully!');
                    closeEditModal();
                    loadAdminStaffData();
                }
            });
        }
        
        // Call this when admin functions are set up
        function initializeAdminForms() {
            setupAdminFunctions();
            setupEditForm();
        }
        
    </script>
    <!-- Auto-backup system -->
    <script src="auto-backup.js"></script>
</body>
</html>