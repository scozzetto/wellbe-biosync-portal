<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1C2630">
    <title>Be Well Check-In</title>
    <link rel="apple-touch-icon" href="logo.svg">
    <!-- Font Awesome for professional icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Allow interaction with buttons - iPad optimized */
        button, .key {
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            will-change: transform;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0f1419;
            color: white;
            overflow: hidden; /* No scroll bars anywhere */
            position: fixed;
            width: 100vw;
            height: 100vh;
            touch-action: manipulation;
        }
        
        /* Hide iPad status bar and create fullscreen experience */
        html {
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        
        /* Force fullscreen and no scrolling */
        html, body {
            height: 100vh;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent any scrolling */
        }
        
        /* Remove status bar overlay - user wants to see status bar without black line */
        
        /* Hide specific iOS status bar elements */
        [class*="status-bar"],
        [id*="status-bar"],
        .status-bar,
        #status-bar {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
        }
        
        .wizard-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            padding: 0;
            padding-top: 50px; /* Increase to 50px padding from the top */
            margin: 0;
            overflow: hidden; /* Ensure no scroll bars */
            position: fixed;
            top: 0;
            left: 0;
        }
        
        /* Progress bar - hidden */
        .progress-bar {
            display: none;
        }
        
        .progress-fill {
            height: 100%;
            background: #A47C5B;
            transition: width 0.3s ease;
            width: 20%;
        }
        
        /* Question area */
        .question-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 5px 20px;
            text-align: center;
            min-height: 0; /* Allow shrinking */
            margin-top: 18px; /* Move everything down 3/4 inch (18px) */
        }
        
        /* Step 2 (phone) specific adjustment - same as step 1 */
        #step2 .question-area {
            margin-top: 18px; /* Move everything down 3/4 inch (18px) same as step 1 */
        }
        
        .question-area h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 300;
            margin-bottom: 15px;
            color: #A47C5B;
            margin-top: 0px; /* Remove all custom positioning, use natural centering */
        }
        
        /* Step 1 specific - move everything under the title down 15px */
        #step1 .input-display,
        #step1 .keyboard-container {
            margin-top: 15px; /* Move input and keyboard down 15px */
        }
        
        /* Step 2 specific - move everything under "Your Phone Number" down 15px */
        #step2 .input-display,
        #step2 .keyboard-container {
            margin-top: 15px; /* Move phone input and number pad down 15px */
        }
        
        .question-area p {
            font-size: clamp(1rem, 3vw, 1.5rem);
            opacity: 0.8;
            margin-bottom: 20px;
        }
        
        /* Input field - iPad optimized */
        .input-display {
            width: 80%;
            max-width: 600px;
            padding: 35px;
            font-size: clamp(1.8rem, 4.5vw, 3rem);
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(164, 124, 91, 0.5);
            border-radius: 16px;
            text-align: center;
            color: white;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            align-items: center;
            justify-content: center;
        }
        
        .input-display.empty {
            color: rgba(255, 255, 255, 0.3);
        }
        
        /* Yes/No buttons */
        .yes-no-container {
            display: flex;
            gap: 40px;
        }
        
        .yes-no-btn {
            padding: 40px 80px;
            font-size: 2.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid rgba(164, 124, 91, 0.5);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .yes-no-btn:active {
            transform: scale(0.95);
        }
        
        .yes-no-btn.yes:hover {
            background: #22c55e;
            border-color: #22c55e;
        }
        
        .yes-no-btn.no:hover {
            background: #ef4444;
            border-color: #ef4444;
        }
        
        /* Service selection */
        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            width: 90%;
            max-width: 900px;
            max-height: 60vh;
            overflow-y: auto;
            padding: 10px;
        }
        
        .service-btn {
            padding: 20px;
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid rgba(164, 124, 91, 0.5);
            border-radius: 16px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .service-btn:hover {
            background: rgba(164, 124, 91, 0.3);
            border-color: #A47C5B;
        }
        
        .service-btn.selected {
            background: #A47C5B;
            border-color: #A47C5B;
        }
        
        /* Keyboard */
        .keyboard-container {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            padding-bottom: 10px;
            border-top: none; /* Remove black line across keyboard */
            flex-shrink: 0; /* Don't shrink keyboard */
            touch-action: manipulation;
        }
        
        .keyboard {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .key {
            background: rgba(255, 255, 255, 0.03);
            border: none; /* Remove all borders to eliminate black lines */
            border-radius: 8px;
            padding: 18px 8px;
            font-size: clamp(1.4rem, 3vw, 2.2rem);
            color: white;
            cursor: pointer;
            transition: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 55px;
            -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            will-change: transform;
        }
        
        .key:active {
            background: rgba(164, 124, 91, 0.5);
            transform: scale(0.95);
        }
        
        .key.space {
            grid-column: span 5;
        }
        
        .key.backspace {
            grid-column: span 2;
            background: rgba(239, 68, 68, 0.2);
        }
        
        .key.next {
            grid-column: span 3;
            background: #A47C5B;
            font-weight: bold;
        }
        
        .key.next:hover {
            background: #8B6349;
        }
        
        /* Number row for phone */
        .number-keyboard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .number-keyboard .key {
            font-size: clamp(1.5rem, 3vw, 2rem);
            padding: 12px;
            min-height: 44px;
        }
        
        /* Success screen */
        .success-screen {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }
        
        .checkmark {
            width: 120px;
            height: 120px;
            background: #22c55e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            margin-bottom: 30px;
            animation: scaleIn 0.5s ease;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
        
        .success-screen h1 {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .success-screen p {
            font-size: 1.5rem;
            opacity: 0.8;
            margin-bottom: 40px;
        }
        
        /* Hide elements */
        .hidden {
            display: none !important;
        }
        
        /* Logo */
        .logo-header {
            position: absolute;
            top: 15px;
            right: 20px;
            z-index: 10;
        }
        
        .logo-header img {
            height: 40px;
            filter: brightness(0) invert(1);
            opacity: 0.6;
        }
        
        /* Back button */
        .back-btn {
            position: absolute;
            top: 35px; /* Move back button down a little bit (15px more) */
            left: 20px;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Hide main interface initially */
        .main-interface {
            transition: opacity 0.5s ease;
        }
        
        .main-interface.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Welcome Screen Styles */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1C2630;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
            transition: opacity 0.5s ease;
        }
        
        .welcome-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Video Background for Welcome Screen */
        .welcome-video-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }
        
        .welcome-video-background video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            object-fit: cover;
        }
        
        /* Welcome Screen Overlay */
        .welcome-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(28, 38, 48, 0.7);
            z-index: 2;
        }
        
        /* Welcome Content */
        .welcome-content {
            position: relative;
            z-index: 3;
            text-align: center;
            padding: 40px;
            max-width: 800px;
        }
        
        .welcome-logo {
            width: 200px;
            height: 200px;
            margin: 0 auto 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 3px solid rgba(164, 124, 91, 0.3);
            animation: welcomePulse 3s ease-in-out infinite;
        }
        
        .welcome-logo img {
            width: 120px;
            height: auto;
            filter: brightness(0) invert(1);
        }
        
        @keyframes welcomePulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 0 0 rgba(164, 124, 91, 0.4);
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 0 0 20px rgba(164, 124, 91, 0);
            }
        }
        
        .welcome-title {
            font-size: clamp(3rem, 8vw, 5rem);
            font-weight: 300;
            color: white;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .welcome-subtitle {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            color: #A47C5B;
            margin-bottom: 40px;
            font-weight: 400;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        /* Professional tap instruction styling */
        .tap-instruction {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 1.8rem;
            font-weight: 600;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            margin-top: 30px;
            animation: pulse 2s infinite;
        }
        
        .tap-icon {
            width: 50px;
            height: 50px;
            background: rgba(164, 124, 91, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            font-size: 1.5rem;
            animation: bounce 2s infinite;
            box-shadow: 0 4px 12px rgba(164, 124, 91, 0.4);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }
        
        
        /* Floating particles animation */
        .welcome-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(164, 124, 91, 0.6);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        .particle:nth-child(1) { left: 10%; animation-delay: 0s; }
        .particle:nth-child(2) { left: 20%; animation-delay: 1s; }
        .particle:nth-child(3) { left: 30%; animation-delay: 2s; }
        .particle:nth-child(4) { left: 40%; animation-delay: 3s; }
        .particle:nth-child(5) { left: 50%; animation-delay: 4s; }
        .particle:nth-child(6) { left: 60%; animation-delay: 5s; }
        .particle:nth-child(7) { left: 70%; animation-delay: 2.5s; }
        .particle:nth-child(8) { left: 80%; animation-delay: 1.5s; }
        .particle:nth-child(9) { left: 90%; animation-delay: 3.5s; }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(100vh);
                opacity: 0;
            }
            10%, 90% {
                opacity: 1;
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        /* Check-in screens video background */
        .checkin-video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }
        
        .checkin-video-background video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        
        .checkin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 20, 25, 0.85);
            z-index: -1;
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen" onclick="startCheckIn()">
        <!-- Video Background -->
        <div class="welcome-video-background">
            <video autoplay muted loop playsinline>
                <source src="videos/happy-people-splash.mp4" type="video/mp4">
                <!-- Fallback background gradient if video doesn't load -->
            </video>
        </div>
        
        <!-- Background Overlay -->
        <div class="welcome-overlay"></div>
        
        <!-- Floating Particles -->
        <!-- Particles removed per user request -->
        
        <!-- Welcome Content -->
        <div class="welcome-content">
            <div class="welcome-logo">
                <img src="logo.svg" alt="Be Well LifeStyle Centers">
            </div>
            <h1 class="welcome-title">Welcome to Be Well</h1>
            <p class="welcome-subtitle">LifeStyle Centers</p>
            <div class="tap-instruction">
                <div class="tap-icon">
                    <i class="fas fa-hand-pointer"></i>
                </div>
                <span>Please Sign In - Tap Here</span>
                <div class="tap-icon">
                    <i class="fas fa-hand-pointer"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Check-In Interface (Hidden Initially) -->
    <div class="main-interface hidden" id="mainInterface">
        <!-- Video Background for check-in screens -->
        <div class="checkin-video-background">
            <video autoplay muted loop playsinline>
                <source src="videos/happy-people-splash.mp4" type="video/mp4">
            </video>
        </div>
        
        <!-- Background Overlay -->
        <div class="checkin-overlay"></div>
        
        <div class="logo-header">
            <img src="logo.svg" alt="Be Well">
        </div>
        
        <button class="back-btn hidden" id="backBtn" onclick="goBack()">‚Üê Back</button>
        
        <div class="wizard-container" id="wizardContainer">
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        
        <!-- Step 1: Name -->
        <div class="step" id="step1">
            <div class="question-area">
                <h1>Please Enter Your First And Last Name</h1>
                <div class="input-display empty" id="nameDisplay">Type your name...</div>
            </div>
            <div class="keyboard-container">
                <div class="keyboard">
                    <button class="key" onclick="addLetter('Q')">Q</button>
                    <button class="key" onclick="addLetter('W')">W</button>
                    <button class="key" onclick="addLetter('E')">E</button>
                    <button class="key" onclick="addLetter('R')">R</button>
                    <button class="key" onclick="addLetter('T')">T</button>
                    <button class="key" onclick="addLetter('Y')">Y</button>
                    <button class="key" onclick="addLetter('U')">U</button>
                    <button class="key" onclick="addLetter('I')">I</button>
                    <button class="key" onclick="addLetter('O')">O</button>
                    <button class="key" onclick="addLetter('P')">P</button>
                    
                    <button class="key" onclick="addLetter('A')">A</button>
                    <button class="key" onclick="addLetter('S')">S</button>
                    <button class="key" onclick="addLetter('D')">D</button>
                    <button class="key" onclick="addLetter('F')">F</button>
                    <button class="key" onclick="addLetter('G')">G</button>
                    <button class="key" onclick="addLetter('H')">H</button>
                    <button class="key" onclick="addLetter('J')">J</button>
                    <button class="key" onclick="addLetter('K')">K</button>
                    <button class="key" onclick="addLetter('L')">L</button>
                    <button class="key backspace" onclick="backspace()">‚Üê</button>
                    
                    <button class="key" onclick="addLetter('Z')">Z</button>
                    <button class="key" onclick="addLetter('X')">X</button>
                    <button class="key" onclick="addLetter('C')">C</button>
                    <button class="key" onclick="addLetter('V')">V</button>
                    <button class="key" onclick="addLetter('B')">B</button>
                    <button class="key" onclick="addLetter('N')">N</button>
                    <button class="key" onclick="addLetter('M')">M</button>
                    <button class="key next" onclick="nextStep()">NEXT ‚Üí</button>
                    
                    <button class="key space" onclick="addLetter(' ')">SPACE</button>
                </div>
            </div>
        </div>
        
        <!-- Step 2: Phone -->
        <div class="step hidden" id="step2">
            <div class="question-area">
                <h1>Your phone number?</h1>
                <div class="input-display empty" id="phoneDisplay">(___) ___-____</div>
            </div>
            <div class="keyboard-container">
                <div class="number-keyboard">
                    <button class="key" onclick="addNumber('1')">1</button>
                    <button class="key" onclick="addNumber('2')">2</button>
                    <button class="key" onclick="addNumber('3')">3</button>
                    <button class="key" onclick="addNumber('4')">4</button>
                    <button class="key" onclick="addNumber('5')">5</button>
                    <button class="key" onclick="addNumber('6')">6</button>
                    <button class="key" onclick="addNumber('7')">7</button>
                    <button class="key" onclick="addNumber('8')">8</button>
                    <button class="key" onclick="addNumber('9')">9</button>
                    <button class="key backspace" onclick="backspacePhone()">‚Üê</button>
                    <button class="key" onclick="addNumber('0')">0</button>
                    <button class="key next" onclick="nextStep()">NEXT ‚Üí</button>
                </div>
            </div>
        </div>
        
        <!-- Step 3: First Visit -->
        <div class="step hidden" id="step3">
            <div class="question-area">
                <h1>Is this your first visit?</h1>
                <div class="yes-no-container">
                    <button class="yes-no-btn yes" onclick="setFirstVisit('YES')">YES<br><small>First Time</small></button>
                    <button class="yes-no-btn no" onclick="setFirstVisit('NO')">NO<br><small>Been Here Before</small></button>
                </div>
            </div>
        </div>
        
        <!-- Step 4: Service -->
        <div class="step hidden" id="step4">
            <div class="question-area">
                <h1>What service are you here for?</h1>
                <p>Select your primary service</p>
                <div class="service-grid">
                    <button class="service-btn" onclick="selectService('Chiropractic')">Chiropractic</button>
                    <button class="service-btn" onclick="selectService('Massage')">Massage</button>
                    <button class="service-btn" onclick="selectService('Dry Needling')">Dry Needling</button>
                    <button class="service-btn" onclick="selectService('Cupping')">Cupping</button>
                    <button class="service-btn" onclick="selectService('IV Therapy')">IV Therapy</button>
                    <button class="service-btn" onclick="selectService('Vitamin Injections')">Vitamin Injections</button>
                    <button class="service-btn" onclick="selectService('Blood Labs')">Blood Labs</button>
                    <button class="service-btn" onclick="selectService('Consultations')">Consultations</button>
                    <button class="service-btn" onclick="selectService('Colon Hydrotherapy')">Colon Hydrotherapy</button>
                    <button class="service-btn" onclick="selectService('Other')">Other</button>
                </div>
            </div>
        </div>
        
        <!-- Step 5: Secondary Service -->
        <div class="step hidden" id="step5">
            <div class="question-area">
                <h1>Any additional service?</h1>
                <p>Select a secondary service or skip</p>
                <div class="service-grid">
                    <button class="service-btn" onclick="selectSecondaryService('Chiropractic')">Chiropractic</button>
                    <button class="service-btn" onclick="selectSecondaryService('Massage')">Massage</button>
                    <button class="service-btn" onclick="selectSecondaryService('Dry Needling')">Dry Needling</button>
                    <button class="service-btn" onclick="selectSecondaryService('Cupping')">Cupping</button>
                    <button class="service-btn" onclick="selectSecondaryService('IV Therapy')">IV Therapy</button>
                    <button class="service-btn" onclick="selectSecondaryService('Vitamin Injections')">Vitamin Injections</button>
                    <button class="service-btn" onclick="selectSecondaryService('Blood Labs')">Blood Labs</button>
                    <button class="service-btn" onclick="selectSecondaryService('Consultations')">Consultations</button>
                    <button class="service-btn" onclick="selectSecondaryService('Colon Hydrotherapy')">Colon Hydrotherapy</button>
                    <button class="service-btn" onclick="selectSecondaryService('Other')">Other</button>
                    <button class="service-btn" onclick="selectSecondaryService('None')" style="grid-column: span 2; background: rgba(107, 114, 128, 0.2);">No Additional Service</button>
                </div>
            </div>
        </div>
        
        <!-- Success Screen -->
        <div class="success-screen" id="successScreen">
            <div class="checkmark">‚úì</div>
            <h1>You're all checked in!</h1>
            <p>Please have a seat and we'll call you shortly.</p>
            <p style="font-size: 1.2rem; opacity: 0.6;">This screen will reset in <span id="countdown">5</span> seconds...</p>
        </div>
    </div>
    </div> <!-- End Main Interface -->
    
    <script>
        // Hide status bar elements on load
        function hideStatusBar() {
            // Try to hide common status bar selectors
            const statusSelectors = [
                '.status-bar', '#status-bar', '[class*="status-bar"]',
                '.statusbar', '#statusbar', '[class*="statusbar"]',
                '.ios-status-bar', '.mobile-status-bar',
                '.status-bar-overlay', '.status-bar-background'
            ];
            
            statusSelectors.forEach(selector => {
                const elements = document.querySelectorAll(selector);
                elements.forEach(el => {
                    el.style.display = 'none';
                    el.style.visibility = 'hidden';
                    el.style.opacity = '0';
                });
            });
            
            // Force fullscreen
            if (document.documentElement.requestFullscreen) {
                document.documentElement.requestFullscreen().catch(() => {});
            } else if (document.documentElement.webkitRequestFullscreen) {
                document.documentElement.webkitRequestFullscreen().catch(() => {});
            }
        }
        
        // Run on load and periodically
        document.addEventListener('DOMContentLoaded', hideStatusBar);
        window.addEventListener('load', hideStatusBar);
        setInterval(hideStatusBar, 1000);
        
        let currentStep = 1;
        let formData = {
            name: '',
            phone: '',
            phoneRaw: '',
            firstVisit: '',
            primaryService: '',
            secondaryService: ''
        };
        
        // Auto-reset timer (60 seconds of inactivity)
        let autoResetTimer = null;
        
        // Welcome screen functionality
        function startCheckIn() {
            console.log('Starting check-in process...');
            
            // Hide welcome screen
            document.getElementById('welcomeScreen').classList.add('hidden');
            
            // Show main interface
            document.getElementById('mainInterface').classList.remove('hidden');
            
            // Initialize the first step
            currentStep = 1;
            document.getElementById('step1').classList.remove('hidden');
            updateProgress();
            
            // Start the auto-reset timer immediately when check-in begins
            resetAutoTimer();
        }
        
        function resetAutoTimer() {
            if (autoResetTimer) {
                clearTimeout(autoResetTimer);
            }
            
            // Start timer if we're in any step (1-5), not on welcome screen (0)
            if (currentStep >= 1) {
                autoResetTimer = setTimeout(() => {
                    console.log('Auto-resetting due to inactivity');
                    resetToStart();
                }, 60000); // 60 seconds (1 minute)
            }
        }
        
        function resetToStart() {
            console.log('Resetting to welcome screen...');
            
            currentStep = 0; // Set to 0 for welcome screen
            formData = {
                name: '',
                phone: '',
                phoneRaw: '',
                firstVisit: '',
                primaryService: '',
                secondaryService: ''
            };
            
            // Hide all steps and main interface
            document.querySelectorAll('.step').forEach(step => step.classList.add('hidden'));
            document.getElementById('mainInterface').classList.add('hidden');
            document.getElementById('successScreen').style.display = 'none';
            document.getElementById('wizardContainer').style.display = 'flex';
            
            // Show welcome screen
            document.getElementById('welcomeScreen').classList.remove('hidden');
            
            // Reset displays
            updateNameDisplay();
            updatePhoneDisplay();
            updateProgress();
            
            // Show progress bar again
            document.querySelector('.progress-bar').style.display = 'block';
            
            // Clear timer
            if (autoResetTimer) {
                clearTimeout(autoResetTimer);
                autoResetTimer = null;
            }
        }
        
        // Update progress bar
        function updateProgress() {
            // Only show progress when in actual steps (1-5), not welcome screen (0)
            const progress = currentStep > 0 ? (currentStep / 5) * 100 : 0;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Show/hide back button - only show when past step 1
            document.getElementById('backBtn').classList.toggle('hidden', currentStep <= 1);
        }
        
        // Name input with debouncing for better iPad performance
        let nameUpdateTimeout = null;
        
        function addLetter(letter) {
            formData.name += letter;
            debouncedUpdateNameDisplay();
            resetAutoTimer();
        }
        
        function backspace() {
            formData.name = formData.name.slice(0, -1);
            debouncedUpdateNameDisplay();
            resetAutoTimer();
        }
        
        function debouncedUpdateNameDisplay() {
            // Clear existing timeout
            if (nameUpdateTimeout) {
                clearTimeout(nameUpdateTimeout);
            }
            
            // Update immediately for responsive feel, but debounce rapid updates
            updateNameDisplay();
            
            // Remove timeout completely for instant response
            // nameUpdateTimeout = setTimeout(() => {
            //     updateNameDisplay();
            // }, 5);
        }
        
        function updateNameDisplay() {
            const display = document.getElementById('nameDisplay');
            // Use requestAnimationFrame for smoother updates
            requestAnimationFrame(() => {
                if (formData.name) {
                    display.textContent = formData.name;
                    display.classList.remove('empty');
                } else {
                    display.textContent = 'Type your name...';
                    display.classList.add('empty');
                }
            });
        }
        
        // Phone input with debouncing for better iPad performance
        let phoneUpdateTimeout = null;
        
        function addNumber(num) {
            if (formData.phoneRaw.length < 10) {
                formData.phoneRaw += num;
                debouncedUpdatePhoneDisplay();
            }
            resetAutoTimer();
        }
        
        function backspacePhone() {
            formData.phoneRaw = formData.phoneRaw.slice(0, -1);
            debouncedUpdatePhoneDisplay();
            resetAutoTimer();
        }
        
        function debouncedUpdatePhoneDisplay() {
            // Clear existing timeout
            if (phoneUpdateTimeout) {
                clearTimeout(phoneUpdateTimeout);
            }
            
            // Update immediately for responsive feel, but debounce rapid updates
            updatePhoneDisplay();
            
            // Remove timeout completely for instant response
            // phoneUpdateTimeout = setTimeout(() => {
            //     updatePhoneDisplay();
            // }, 5);
        }
        
        function updatePhoneDisplay() {
            const display = document.getElementById('phoneDisplay');
            const raw = formData.phoneRaw;
            
            // Use requestAnimationFrame for smoother updates
            requestAnimationFrame(() => {
                if (raw.length === 0) {
                    display.textContent = '(___) ___-____';
                    display.classList.add('empty');
                } else {
                    let formatted = '(';
                    for (let i = 0; i < 10; i++) {
                        if (i < raw.length) {
                            formatted += raw[i];
                        } else {
                            formatted += '_';
                        }
                        if (i === 2) formatted += ') ';
                        if (i === 5) formatted += '-';
                    }
                    display.textContent = formatted;
                    display.classList.remove('empty');
                    
                    // Store formatted version
                    if (raw.length === 10) {
                        formData.phone = `(${raw.slice(0,3)}) ${raw.slice(3,6)}-${raw.slice(6,10)}`;
                    }
                }
            });
        }
        
        // First visit
        function setFirstVisit(value) {
            formData.firstVisit = value;
            resetAutoTimer();
            nextStep();
        }
        
        // Service selection
        function selectService(service) {
            formData.primaryService = service;
            resetAutoTimer();
            nextStep();
        }
        
        function selectSecondaryService(service) {
            formData.secondaryService = service === 'None' ? '' : service;
            resetAutoTimer();
            console.log('üéØ About to call submitCheckIn for:', formData.name);
            submitCheckIn();
        }
        
        // Navigation
        function nextStep() {
            resetAutoTimer();
            // Validation
            if (currentStep === 1 && !formData.name.trim()) {
                return;
            }
            if (currentStep === 2 && formData.phoneRaw.length !== 10) {
                return;
            }
            
            // Hide current step
            document.getElementById('step' + currentStep).classList.add('hidden');
            
            // Show next step
            currentStep++;
            if (currentStep <= 5) {
                document.getElementById('step' + currentStep).classList.remove('hidden');
                updateProgress();
                
                // Start auto-reset timer when moving past welcome screen
                if (currentStep === 2) {
                    resetAutoTimer();
                }
            }
        }
        
        function goBack() {
            if (currentStep > 1) {
                document.getElementById('step' + currentStep).classList.add('hidden');
                currentStep--;
                document.getElementById('step' + currentStep).classList.remove('hidden');
                updateProgress();
                resetAutoTimer();
            }
        }
        
        // Bright, ding-y bell notification function
        function playCheckInAlert() {
            try {
                // Create audio context for bright ding sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Create oscillators for bright, sparkly ding
                const ding1 = audioContext.createOscillator();
                const ding2 = audioContext.createOscillator();
                
                // Create gain nodes
                const gain1 = audioContext.createGain();
                const gain2 = audioContext.createGain();
                const masterGain = audioContext.createGain();
                
                // Connect everything
                ding1.connect(gain1);
                ding2.connect(gain2);
                gain1.connect(masterGain);
                gain2.connect(masterGain);
                masterGain.connect(audioContext.destination);
                
                // Set frequencies for bright, sparkly ding
                // Higher frequencies for brighter sound
                ding1.frequency.setValueAtTime(1046.5, audioContext.currentTime); // C6 - bright and clear
                ding2.frequency.setValueAtTime(1318.5, audioContext.currentTime); // E6 - major third for pleasant harmony
                
                // Quick attack, quick decay for "ding" effect
                gain1.gain.setValueAtTime(0, audioContext.currentTime);
                gain2.gain.setValueAtTime(0, audioContext.currentTime);
                masterGain.gain.setValueAtTime(0.6, audioContext.currentTime); // Good volume
                
                // Quick attack
                gain1.gain.linearRampToValueAtTime(0.8, audioContext.currentTime + 0.01);
                gain2.gain.linearRampToValueAtTime(0.6, audioContext.currentTime + 0.01);
                
                // Quick decay for sparkly ding
                gain1.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.2);
                gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.0);
                
                // Start oscillators
                ding1.start(audioContext.currentTime);
                ding2.start(audioContext.currentTime);
                
                // Stop oscillators
                ding1.stop(audioContext.currentTime + 1.2);
                ding2.stop(audioContext.currentTime + 1.0);
                
                console.log('üîî Bright ding alert played');
            } catch (e) {
                console.log('Audio not supported or blocked:', e);
                // Simple fallback ding
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(1046.5, audioContext.currentTime); // High C
                    gainNode.gain.setValueAtTime(0.6, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.8);
                    
                    console.log('üîî Fallback ding played');
                } catch (e2) {
                    console.log('All audio methods failed:', e2);
                }
            }
        }

        // Submit check-in
        function submitCheckIn() {
            console.log('üõéÔ∏è submitCheckIn fired for:', formData);
            
            const checkinData = {
                name: formData.name,
                phone: formData.phone,
                firstVisit: formData.firstVisit,
                reason: formData.primaryService,
                subReason: formData.secondaryService ? formData.primaryService + ' + ' + formData.secondaryService : formData.primaryService,
                dateIn: new Date().toISOString().split('T')[0],
                timeIn: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }),
                source: 'Kiosk',
                ackTime: '',
                ackBy: '',
                outTime: '',
                outBy: '',
                comment: '',
                status: 'waiting',
                id: Date.now().toString(),
                timestamp: new Date().toISOString()
            };
            
            // Save to MULTIPLE places to ensure it works
            let checkins = JSON.parse(localStorage.getItem('allCheckins') || '[]');
            checkins.push(checkinData);
            
            // Save to primary key with error handling
            try {
                localStorage.setItem('allCheckins', JSON.stringify(checkins));
            } catch (err) {
                console.error('localStorage save error:', err);
            }
            
            // Also save to backup key
            try {
                localStorage.setItem('patientCheckins', JSON.stringify(checkins));
            } catch (err) {
                console.error('patientCheckins save error:', err);
            }
            
            // Save individual record for cross-domain sync
            try {
                localStorage.setItem('checkin_' + checkinData.id, JSON.stringify(checkinData));
            } catch (err) {
                console.error('individual key save error:', err);
            }
            
            // CRITICAL: Also save to a simple storage format for dashboard
            try {
                localStorage.setItem('latest_checkin', JSON.stringify({
                    ...checkinData,
                    saveTime: Date.now()
                }));
            } catch (err) {
                console.error('latest_checkin save error:', err);
            }
            
            
            // FORCE DEBUG - Show exactly what we saved
            console.log('=== POOP DEBUG ===');
            console.log('Current URL:', window.location.href);
            console.log('Saved checkin:', checkinData);
            console.log('Total checkins after save:', checkins.length);
            console.log('Saved to allCheckins:', localStorage.getItem('allCheckins') ? 'YES' : 'NO');
            console.log('Saved to patientCheckins:', localStorage.getItem('patientCheckins') ? 'YES' : 'NO');
            
            // Try posting to parent window if in iframe
            try {
                if (window.parent && window.parent !== window) {
                    window.parent.postMessage({
                        type: 'CHECKIN_SAVED', 
                        data: checkinData
                    }, '*');
                    console.log('Posted to parent window');
                }
            } catch (e) {
                console.log('Could not post to parent:', e);
            }
            
            // Send to server for cross-domain sync
            try {
                fetch('/.netlify/functions/checkin-sync-v2', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(checkinData)
                })
                .then(response => response.json())
                .then(result => {
                    console.log('Server sync result:', result);
                    if (result.success) {
                        console.log('‚úÖ Check-in synced to server successfully');
                    }
                })
                .catch(error => {
                    console.warn('Server sync failed (fallback to localStorage):', error);
                });
            } catch (e) {
                console.log('Could not sync to server:', e);
            }
            
            // Try to send to dashboard if it's open
            try {
                if (window.opener && !window.opener.closed) {
                    window.opener.postMessage({
                        type: 'NEW_CHECKIN',
                        data: checkinData
                    }, '*');
                }
            } catch (e) {
                console.log('Could not send to dashboard:', e);
            }
            
            // Debug logging
            console.log('CHECK-IN SAVED:', checkinData);
            console.log('Total checkins now:', checkins.length);
            console.log('All checkins:', checkins);
            console.log('Current URL when saving:', window.location.href);
            
            // No alert needed
            
            // Play audio alert for front desk
            playCheckInAlert();
            
            // Show success screen
            document.getElementById('step5').classList.add('hidden');
            document.getElementById('successScreen').style.display = 'flex';
            document.getElementById('backBtn').style.display = 'none';
            // Hide progress bar
            document.querySelector('.progress-bar').style.display = 'none';
            
            // Countdown and reset
            let countdown = 5;
            const countdownInterval = setInterval(() => {
                countdown--;
                document.getElementById('countdown').textContent = countdown;
                
                if (countdown === 0) {
                    clearInterval(countdownInterval);
                    resetToStart(); // Reset to welcome screen instead of reload
                }
            }, 1000);
        }
        
        // Initialize - Start with welcome screen
        function initializeApp() {
            currentStep = 0; // Start on welcome screen
            
            // Hide all steps initially
            document.querySelectorAll('.step').forEach(step => step.classList.add('hidden'));
            
            // Show welcome screen, hide main interface
            document.getElementById('welcomeScreen').classList.remove('hidden');
            document.getElementById('mainInterface').classList.add('hidden');
            
            updateProgress();
        }
        
        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
        
        // Test localStorage on load
        window.addEventListener('load', function() {
            console.log('PATIENT CHECK-IN PAGE LOADED');
            console.log('Current URL:', window.location.href);
            console.log('LocalStorage test:', localStorage.getItem('allCheckins') ? 'HAS DATA' : 'EMPTY');
        });
        
        // Allow keyboard touches but prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>